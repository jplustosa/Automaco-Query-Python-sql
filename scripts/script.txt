-- SCRIPT DE EXEMPLO, DADOS "N√ÉO" REAIS

SELECT 
    CLIENTE.ID AS CODIGO_CLIENTE,
    CLIENTE.NOME AS NOME_CLIENTE,
    CLIENTE.EMAIL,
    CLIENTE.TELEFONE,
    TO_CHAR(CLIENTE.DATA_CADASTRO, 'DD/MM/YYYY') AS DATA_CADASTRO,
    CIDADE.NOME AS CIDADE,
    ESTADO.UF,
    COUNT(PEDIDO.ID) AS TOTAL_PEDIDOS,
    SUM(PEDIDO.VALOR_TOTAL) AS VALOR_TOTAL_COMPRAS
FROM CLIENTES CLIENTE
LEFT JOIN PEDIDOS PEDIDO ON CLIENTE.ID = PEDIDO.CLIENTE_ID
LEFT JOIN CIDADE ON CLIENTE.CIDADE_ID = CIDADE.ID
LEFT JOIN ESTADO ON CIDADE.ESTADO_ID = ESTADO.ID
WHERE CLIENTE.STATUS = 'ATIVO'
GROUP BY CLIENTE.ID, CLIENTE.NOME, CLIENTE.EMAIL, CLIENTE.TELEFONE, 
         CLIENTE.DATA_CADASTRO, CIDADE.NOME, ESTADO.UF
ORDER BY VALOR_TOTAL_COMPRAS DESC, NOME_CLIENTE